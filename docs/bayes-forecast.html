<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Bayes Forecast | Bayesian Finance: Modeling Earnings for S&amp;P 500 Companies</title>
  <meta name="description" content="Bayesian Statistics Capstone Project" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Bayes Forecast | Bayesian Finance: Modeling Earnings for S&amp;P 500 Companies" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Bayesian Statistics Capstone Project" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Bayes Forecast | Bayesian Finance: Modeling Earnings for S&amp;P 500 Companies" />
  
  <meta name="twitter:description" content="Bayesian Statistics Capstone Project" />
  

<meta name="author" content="Nicholas Di, Nolan Meyer, Duc Ngo" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="models-with-hierarchical-structure.html"/>
<link rel="next" href="finalmodel.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STAT 454 Capstone</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#motivation"><i class="fa fa-check"></i><b>1.2</b> Motivation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data.html"><a href="data.html#data-source"><i class="fa fa-check"></i><b>2.1</b> Data Source</a></li>
<li class="chapter" data-level="2.2" data-path="data.html"><a href="data.html#variables"><i class="fa fa-check"></i><b>2.2</b> Variables</a></li>
<li class="chapter" data-level="2.3" data-path="data.html"><a href="data.html#data-cleaning"><i class="fa fa-check"></i><b>2.3</b> Data Cleaning</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data.html"><a href="data.html#data-pre-processing"><i class="fa fa-check"></i><b>2.3.1</b> Data Pre-Processing</a></li>
<li class="chapter" data-level="2.3.2" data-path="data.html"><a href="data.html#graphing-outliers"><i class="fa fa-check"></i><b>2.3.2</b> Graphing Outliers</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data.html"><a href="data.html#initial-explorations"><i class="fa fa-check"></i><b>2.4</b> Initial Explorations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modeling.html"><a href="modeling.html"><i class="fa fa-check"></i><b>3</b> Models w/o hierarchical structure</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modeling.html"><a href="modeling.html#set-up"><i class="fa fa-check"></i><b>3.1</b> Set Up</a></li>
<li class="chapter" data-level="3.2" data-path="modeling.html"><a href="modeling.html#model-1"><i class="fa fa-check"></i><b>3.2</b> Model 1</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="modeling.html"><a href="modeling.html#model-structure"><i class="fa fa-check"></i><b>3.2.1</b> Model Structure</a></li>
<li class="chapter" data-level="3.2.2" data-path="modeling.html"><a href="modeling.html#model-evaluation"><i class="fa fa-check"></i><b>3.2.2</b> Model Evaluation</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="modeling.html"><a href="modeling.html#model-1-w-interaction"><i class="fa fa-check"></i><b>3.3</b> Model 1 w/ Interaction</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="modeling.html"><a href="modeling.html#model-structure-1"><i class="fa fa-check"></i><b>3.3.1</b> Model Structure</a></li>
<li class="chapter" data-level="3.3.2" data-path="modeling.html"><a href="modeling.html#model-evaluation-1"><i class="fa fa-check"></i><b>3.3.2</b> Model Evaluation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="models-with-hierarchical-structure.html"><a href="models-with-hierarchical-structure.html"><i class="fa fa-check"></i><b>4</b> Models with hierarchical structure</a>
<ul>
<li class="chapter" data-level="4.1" data-path="models-with-hierarchical-structure.html"><a href="models-with-hierarchical-structure.html#model-2"><i class="fa fa-check"></i><b>4.1</b> Model 2</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="models-with-hierarchical-structure.html"><a href="models-with-hierarchical-structure.html#model-structure-2"><i class="fa fa-check"></i><b>4.1.1</b> Model Structure</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="models-with-hierarchical-structure.html"><a href="models-with-hierarchical-structure.html#model-3"><i class="fa fa-check"></i><b>4.2</b> Model 3</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="models-with-hierarchical-structure.html"><a href="models-with-hierarchical-structure.html#model-structure-3"><i class="fa fa-check"></i><b>4.2.1</b> Model Structure</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="models-with-hierarchical-structure.html"><a href="models-with-hierarchical-structure.html#model-evaluations"><i class="fa fa-check"></i><b>4.3</b> Model Evaluations</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="models-with-hierarchical-structure.html"><a href="models-with-hierarchical-structure.html#is-this-the-right-model"><i class="fa fa-check"></i><b>4.3.1</b> Is this the right model?</a></li>
<li class="chapter" data-level="4.3.2" data-path="models-with-hierarchical-structure.html"><a href="models-with-hierarchical-structure.html#how-accurate-are-the-models"><i class="fa fa-check"></i><b>4.3.2</b> How Accurate are the models?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-forecast.html"><a href="bayes-forecast.html"><i class="fa fa-check"></i><b>5</b> Bayes Forecast</a>
<ul>
<li class="chapter" data-level="5.1" data-path="bayes-forecast.html"><a href="bayes-forecast.html#model-parameters"><i class="fa fa-check"></i><b>5.1</b> Model Parameters</a></li>
<li class="chapter" data-level="5.2" data-path="bayes-forecast.html"><a href="bayes-forecast.html#model-1-1"><i class="fa fa-check"></i><b>5.2</b> Model 1</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="finalmodel.html"><a href="finalmodel.html"><i class="fa fa-check"></i><b>6</b> Final Model</a></li>
<li class="chapter" data-level="7" data-path="reflection.html"><a href="reflection.html"><i class="fa fa-check"></i><b>7</b> Reflection</a>
<ul>
<li class="chapter" data-level="7.1" data-path="reflection.html"><a href="reflection.html#next-steps"><i class="fa fa-check"></i><b>7.1</b> Next Steps</a></li>
<li class="chapter" data-level="7.2" data-path="reflection.html"><a href="reflection.html#acknowledgements"><i class="fa fa-check"></i><b>7.2</b> Acknowledgements</a></li>
<li class="chapter" data-level="7.3" data-path="reflection.html"><a href="reflection.html#citations"><i class="fa fa-check"></i><b>7.3</b> Citations</a></li>
<li class="chapter" data-level="7.4" data-path="reflection.html"><a href="reflection.html#code-appendix"><i class="fa fa-check"></i><b>7.4</b> Code Appendix</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Finance: Modeling Earnings for S&amp;P 500 Companies</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayes-forecast" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Bayes Forecast</h1>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="bayes-forecast.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesforecast)</span></code></pre></div>
<p><strong>Bayesian Forecast SARIMA:</strong></p>
<p>In our last model specification, we decided to use the bayesforecast package. In particular we are fitting a SARIMA model in Stan.</p>
<p>SARIMA stands for seasonal auto-regressive integrated moving average. This is an extension of ARIMA and is therefore more robust as it is able to support seasonal data.</p>
<p>ARIMA is a method that combines both auto-regressive methods and moving averages- it is widely used on time series data in attempts to predict future values. There are four components that explain time series data, trend, seasonality, irregularity, and cyclic components.</p>
<div id="model-parameters" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Model Parameters</h2>
<p>Here are the parameters for an ARIMA model:</p>
<p>P - Order of the AR term. This is the number of Y to be used as predictors. For example, if we are predicting 2021 earnings, how many previous years earnings are we going to use?</p>
<p>Q - Order of the MA term. This is the number of lagged forecast errors. How many past forecast errors will we be using?</p>
<p>D - The minimum differencing period. A stationary time series implies one that has properties that do not depend on the time at which the series is observed.</p>
<p>As mentioned above, SARIMA is able to support seasonal data. Below are the parameters for a SARIMA model that ARIMA does not have.</p>
<p>P - Seasonal autoregressive order. A P=1 would make use of the first seasonally offset observation in the model, e.g. t-(m1) or t-12. A P=2, would use the last two seasonally offset observations t-(m1), t-(m2).</p>
<p>D - Seasonal difference order. A D of 1 would calculate a first order seasonal difference and a Q=1 would use a first order error in the model (e.g. moving average).</p>
<p>Q - Seasonal moving average order.</p>
<p>M - The number of time steps for a single seasonal period. M is a very important parameter as it influences the P, D, and Q parameters. For example, an m of 5 for yearly data suggests a 5-year seasonal cycle (in the context of business cycles.</p>
</div>
<div id="model-1-1" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Model 1</h2>
<p>After running the model, we will then move on to predict the earnings of the future year for the companies. The companies we are going to predict will be Amazon (symbol: “AMZN”), American Airlines (symbol: “AAL”), and Ford (symbol: “F”).</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="bayes-forecast.html#cb41-1" aria-hidden="true" tabindex="-1"></a>AMZN <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="bayes-forecast.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COMPANY <span class="sc">==</span> <span class="st">&#39;AMZN&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="bayes-forecast.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(EARNINGS_Scaled) <span class="sc">%&gt;%</span> </span>
<span id="cb41-4"><a href="bayes-forecast.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(EARNINGS_Scaled)</span>
<span id="cb41-5"><a href="bayes-forecast.html#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="bayes-forecast.html#cb41-6" aria-hidden="true" tabindex="-1"></a>vector <span class="ot">&lt;-</span> AMZN<span class="sc">$</span>EARNINGS_Scaled</span>
<span id="cb41-7"><a href="bayes-forecast.html#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="bayes-forecast.html#cb41-8" aria-hidden="true" tabindex="-1"></a>myts <span class="ot">&lt;-</span> <span class="fu">ts</span>(vector, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1999</span>), <span class="at">end=</span><span class="fu">c</span>(<span class="dv">2021</span>), <span class="at">frequency=</span><span class="dv">1</span>)</span>
<span id="cb41-9"><a href="bayes-forecast.html#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="bayes-forecast.html#cb41-10" aria-hidden="true" tabindex="-1"></a>sf1 <span class="ot">=</span> <span class="fu">stan_sarima</span>(<span class="at">ts =</span> myts,<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb41-11"><a href="bayes-forecast.html#cb41-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">prior_mu0 =</span> <span class="fu">student</span>(<span class="at">mu =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="dv">1</span>,<span class="at">df =</span> <span class="dv">7</span>))</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="bayes-forecast.html#cb42-1" aria-hidden="true" tabindex="-1"></a>sf1</span></code></pre></div>
<pre><code>## 
## y ~ Sarima(1,1,1) 
## 23 observations and 1 dimension 
## Differences: 1 seasonal Differences: 0 
## Current observations: 22 
##  
##            mean     se       5%      95%      ess   Rhat
## mu0      0.6122 0.0074  -0.0389   1.4521 3946.370 1.0002
## sigma0   2.2608 0.0055   1.7567   2.8966 3880.739 0.9999
## ar       0.4249 0.0068  -0.4297   0.9536 3504.369 1.0006
## ma      -0.1344 0.0046  -0.5678   0.3905 3646.405 1.0012
## loglik -50.2659 0.0246 -52.8948 -47.7647 3635.604 1.0000
## 
##  Samples were drawn using sampling(NUTS). For each parameter, ess
##  is the effective sample size, and Rhat is the potential
##  scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="bayes-forecast.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_residuals</span>(sf1)</span></code></pre></div>
<p><img src="series_files/figure-html/fig3-1.png" width="672" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="bayes-forecast.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(<span class="fu">forecast</span>(<span class="at">object =</span> sf1,<span class="at">h =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="series_files/figure-html/fig3-2.png" width="672" /></p>
<p>First, for Amazon, we could see that the earnings are predicted to increase from 2021 to 2030, moving from 21 billions to around 38 billions in 2030.</p>
<p>For the residuals plot, we can see that the residuals expect to increase in the future and keep increasing as the farther from 2020, the data becomes more and more unpredictable. Overall, the residuals lie around -1 and 0, which suggests that the error is not that far off from the actual value.</p>
<p>We then move on to the other companies: Microsoft and American Airlines:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="bayes-forecast.html#cb46-1" aria-hidden="true" tabindex="-1"></a>AAL <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="bayes-forecast.html#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COMPANY <span class="sc">==</span> <span class="st">&#39;AAL&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="bayes-forecast.html#cb46-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(EARNINGS_Scaled) <span class="sc">%&gt;%</span> </span>
<span id="cb46-4"><a href="bayes-forecast.html#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(EARNINGS_Scaled)</span>
<span id="cb46-5"><a href="bayes-forecast.html#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="bayes-forecast.html#cb46-6" aria-hidden="true" tabindex="-1"></a>vector <span class="ot">&lt;-</span> AAL<span class="sc">$</span>EARNINGS_Scaled</span>
<span id="cb46-7"><a href="bayes-forecast.html#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="bayes-forecast.html#cb46-8" aria-hidden="true" tabindex="-1"></a>myts <span class="ot">&lt;-</span> <span class="fu">ts</span>(vector, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1999</span>), <span class="at">end=</span><span class="fu">c</span>(<span class="dv">2021</span>), <span class="at">frequency=</span><span class="dv">1</span>)</span>
<span id="cb46-9"><a href="bayes-forecast.html#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="bayes-forecast.html#cb46-10" aria-hidden="true" tabindex="-1"></a>sf1 <span class="ot">=</span> <span class="fu">stan_sarima</span>(<span class="at">ts =</span> myts,<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb46-11"><a href="bayes-forecast.html#cb46-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">prior_mu0 =</span> <span class="fu">student</span>(<span class="at">mu =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="dv">1</span>,<span class="at">df =</span> <span class="dv">7</span>))</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="bayes-forecast.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_residuals</span>(sf1)</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="bayes-forecast.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(<span class="fu">forecast</span>(<span class="at">object =</span> sf1,<span class="at">h =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-47-2.png" width="672" /></p>
<p>For American Airlines, we see a different story. As we can see from the graph, as airlines industry is an extremely cyclical field, the earnings fluctuate a lot. We could see that they fluctuate a lot during the previous years. With that in mind, the model predicts that American Airlines will not improve the much during the following years from 2021 to 2030.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="bayes-forecast.html#cb49-1" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href="bayes-forecast.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COMPANY <span class="sc">==</span> <span class="st">&#39;F&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="bayes-forecast.html#cb49-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(EARNINGS_Scaled) <span class="sc">%&gt;%</span> </span>
<span id="cb49-4"><a href="bayes-forecast.html#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(EARNINGS_Scaled)</span>
<span id="cb49-5"><a href="bayes-forecast.html#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="bayes-forecast.html#cb49-6" aria-hidden="true" tabindex="-1"></a>vector <span class="ot">&lt;-</span> F<span class="sc">$</span>EARNINGS_Scaled</span>
<span id="cb49-7"><a href="bayes-forecast.html#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="bayes-forecast.html#cb49-8" aria-hidden="true" tabindex="-1"></a>myts <span class="ot">&lt;-</span> <span class="fu">ts</span>(vector, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1999</span>), <span class="at">end=</span><span class="fu">c</span>(<span class="dv">2021</span>), <span class="at">frequency=</span><span class="dv">1</span>)</span>
<span id="cb49-9"><a href="bayes-forecast.html#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="bayes-forecast.html#cb49-10" aria-hidden="true" tabindex="-1"></a>sf1 <span class="ot">=</span> <span class="fu">stan_sarima</span>(<span class="at">ts =</span> myts,<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb49-11"><a href="bayes-forecast.html#cb49-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">prior_mu0 =</span> <span class="fu">student</span>(<span class="at">mu =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="dv">1</span>,<span class="at">df =</span> <span class="dv">7</span>))</span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="bayes-forecast.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_residuals</span>(sf1)</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="bayes-forecast.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(<span class="fu">forecast</span>(<span class="at">object =</span> sf1,<span class="at">h =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-49-2.png" width="672" /></p>
<p>For Ford, it follows the same case as American Airlines. Even though the earnings increase, the model predicts that Ford’s earning will stay relatively the same throughout the year from 2021 to 2030. For the residuals part, the residuals fluctuate around -1 to 1, with some exceptions of 6 and 11 in around 2002 and 2020 (the year when COVID-19 started).</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="models-with-hierarchical-structure.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="finalmodel.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
